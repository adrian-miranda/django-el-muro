{% extends 'base.html'%}
{% block titulo%}{{titulo}}{% endblock%}
{%block contenido%}

{%if request.session.usuario%}
{%include 'menu.html'%}
{%endif%}
<div class="container">
    <div class="row">
        <div class="col-lg-6 offset-lg-3 w-50">
            <form action="crearMensaje/{{request.session.usuario.id}}" method="post">
                {% csrf_token %}
                <h2>Post a message</h2>
                <!-- <input type="text" name="mensaje" id="" class="w-100 h-100 form-control" rows="10"> -->
                <textarea name="mensaje" id="" class="w-100 h-100 form-control" rows="5"></textarea>
                <div class=" d-grid gap-2 d-md-flex justify-content-md-end mt-3">
                    <button type="submit" class="btn btn-primary text-ligth">Post a message</button>
                </div>
            </form>
        </div>
    </div>
</div>
<div class="container mt-3">
    <div class="row">
        <div class="col-lg-6  offset-lg-3 w-100">
            {%for mensaje in mensajes%}
            <h5>{{mensaje.usuario.first_name}} - {{mensaje.created_at}} -- {{mensaje.id}}</h5>
            <p>{{mensaje.mensaje}}</p>
            
            <div class="comentario">
                {%for comentario in comentarios%}
                {%if comentario.mensaje.id == mensaje.id%}
                <h5>Nombre: {{comentario.usuario.first_name}}<br>Fecha: {{comentario.created_at}}</h5>
                <p class="w-50">Dijo:<br>{{comentario.comentario}}</p>
                {%endif%}
                {%empty%}
                <h5>No  hay comentarios</h5>
                {%endfor%}
            </div>
            <div class="comentar">
                <form action="crearComentario/{{mensaje.id}}" method="POST">
                    {% csrf_token %}
                    <h5>Post a comment</h5>
                    <textarea name="comentario" id="" class="w-50 form-control h-100 mt-2 mb-4" rows="3"></textarea>
                    <div class="d-flex justify-content-end w-50">
                        <button type="submit" class="btn btn-primary text-ligth">Post a Comment</button>
                        <!-- Link para borrar , falta validar si es el titular quein loo esta borrando -->
                        <a href="delete/{{mensaje.id}}" class="btn btn-danger text-ligth mx-2">Delete a message</a>
                    </div>
                </form>
                
            </div>
            <hr class="w-50">
            {%endfor%}
        </div>
    </div>
</div>
{%endblock%}